/**
 * Commercial Syrup Marketplace Component
 * 
 * Interactive marketplace for browsing and discovering commercial syrups with
 * advanced filtering, regional availability, user reviews, and smart recommendations.
 * Integrates with Amazon regional pricing and provides substitution suggestions.
 * 
 * @example
 * ```tsx
 * import { SyrupMarketplace } from '@/components/premade/SyrupMarketplace';
 * 
 * export default function MarketplacePage() {
 *   return <SyrupMarketplace />;
 * }
 * ```
 */\n\n'use client';\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Badge } from '@/components/ui/badge';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\nimport { Progress } from '@/components/ui/progress';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { OptimizedImage } from '@/components/ui/optimized-image';\nimport { \n  Search, \n  Filter, \n  Star, \n  MapPin, \n  ShoppingCart, \n  Heart, \n  Share2, \n  TrendingUp, \n  Clock, \n  Award, \n  DollarSign, \n  Package, \n  Truck, \n  Shield,\n  ChevronDown,\n  ChevronRight,\n  ExternalLink,\n  Bookmark,\n  BarChart3,\n  RefreshCw\n} from 'lucide-react';\nimport { PremadeSyrup, SyrupMarketplaceFilter, SyrupRecommendation } from '@/lib/types';\nimport { PremadeSyrupService } from '@/lib/premade-syrups';\n\n/**\n * Syrup Marketplace Props\n * \n * Configuration options for the marketplace component including\n * initial filters, regional settings, and display preferences.\n */\ninterface SyrupMarketplaceProps {\n  initialFilter?: Partial<SyrupMarketplaceFilter>;\n  region?: string;\n  currency?: string;\n  onSyrupSelect?: (syrup: PremadeSyrup) => void;\n  onAddToCart?: (syrup: PremadeSyrup, quantity: number) => void;\n  showQuickActions?: boolean;\n  enableComparison?: boolean;\n  className?: string;\n}\n\n/**\n * Filter State Interface\n * \n * Internal state for managing marketplace filters and search functionality.\n */\ninterface FilterState {\n  searchQuery: string;\n  selectedBrands: string[];\n  selectedCategories: string[];\n  selectedConcentrations: string[];\n  priceRange: { min: number; max: number };\n  selectedAvailability: string[];\n  minRating: number;\n  compatibleFlavors: string[];\n  sortBy: string;\n  sortOrder: 'asc' | 'desc';\n}\n\n/**\n * Syrup Card Props\n * \n * Props for individual syrup display cards with interactive features.\n */\ninterface SyrupCardProps {\n  syrup: PremadeSyrup;\n  region: string;\n  onSelect: (syrup: PremadeSyrup) => void;\n  onAddToCart: (syrup: PremadeSyrup, quantity: number) => void;\n  onToggleFavorite: (syrupId: string) => void;\n  isFavorite: boolean;\n  showQuickActions?: boolean;\n  enableComparison?: boolean;\n}\n\n/**\n * Comparison Modal Props\n * \n * Props for side-by-side syrup comparison functionality.\n */\ninterface ComparisonModalProps {\n  selectedSyrups: PremadeSyrup[];\n  region: string;\n  isOpen: boolean;\n  onClose: () => void;\n  onSelectForComparison: (syrup: PremadeSyrup) => void;\n}\n\n/**\n * Individual Syrup Card Component\n */\nconst SyrupCard: React.FC<SyrupCardProps> = ({\n  syrup,\n  region,\n  onSelect,\n  onAddToCart,\n  onToggleFavorite,\n  isFavorite,\n  showQuickActions = true,\n  enableComparison = false\n}) => {\n  const [quantity, setQuantity] = useState(1);\n  const [isAddingToCart, setIsAddingToCart] = useState(false);\n  \n  const regionalPricing = syrup.regionalPricing[region] || Object.values(syrup.regionalPricing)[0];\n  const pricePerMl = regionalPricing.price / 750; // Assuming 750ml bottles\n  \n  const handleAddToCart = async () => {\n    setIsAddingToCart(true);\n    try {\n      await onAddToCart(syrup, quantity);\n    } finally {\n      setIsAddingToCart(false);\n    }\n  };\n  \n  return (\n    <Card className=\"h-full flex flex-col hover:shadow-lg transition-shadow duration-200\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex-1\">\n            <CardTitle className=\"text-lg font-semibold text-gray-900 line-clamp-2\">\n              {syrup.name}\n            </CardTitle>\n            <CardDescription className=\"text-sm text-gray-600 mt-1\">\n              {syrup.brand} • {syrup.category}\n            </CardDescription>\n          </div>\n          <div className=\"flex flex-col items-end space-y-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => onToggleFavorite(syrup.id)}\n              className={`p-1 ${isFavorite ? 'text-red-500' : 'text-gray-400'}`}\n            >\n              <Heart className={`h-4 w-4 ${isFavorite ? 'fill-current' : ''}`} />\n            </Button>\n            {enableComparison && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => onSelect(syrup)}\n                className=\"p-1 text-gray-400\"\n              >\n                <BarChart3 className=\"h-4 w-4\" />\n              </Button>\n            )}\n          </div>\n        </div>\n      </CardHeader>\n      \n      <CardContent className=\"flex-1 flex flex-col\">\n        {/* Image and Basic Info */}\n        <div className=\"flex items-start space-x-4 mb-4\">\n          <div className=\"w-16 h-16 bg-gradient-to-br from-blue-100 to-purple-100 rounded-lg flex items-center justify-center flex-shrink-0\">\n            <Package className=\"h-8 w-8 text-gray-400\" />\n          </div>\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"flex items-center space-x-2 mb-2\">\n              <Badge variant=\"secondary\" className=\"text-xs\">\n                {syrup.concentration}\n              </Badge>\n              <Badge \n                variant={syrup.availability === 'in-stock' ? 'default' : 'destructive'}\n                className=\"text-xs\"\n              >\n                {syrup.availability}\n              </Badge>\n            </div>\n            <div className=\"flex items-center space-x-1 mb-1\">\n              <Star className=\"h-4 w-4 text-yellow-400 fill-current\" />\n              <span className=\"text-sm font-medium\">{syrup.rating.toFixed(1)}</span>\n              <span className=\"text-xs text-gray-500\">({syrup.reviewCount.toLocaleString()})</span>\n            </div>\n            <div className=\"text-xs text-gray-500\">\n              {syrup.dilutionRatio} dilution\n            </div>\n          </div>\n        </div>\n        \n        {/* Taste Profile */}\n        <div className=\"mb-4\">\n          <div className=\"text-xs text-gray-600 mb-1\">Taste Profile</div>\n          <div className=\"flex flex-wrap gap-1\">\n            {syrup.tasteProfile.notes.slice(0, 3).map((note, index) => (\n              <Badge key={index} variant=\"outline\" className=\"text-xs\">\n                {note}\n              </Badge>\n            ))}\n            {syrup.tasteProfile.notes.length > 3 && (\n              <Badge variant=\"outline\" className=\"text-xs\">\n                +{syrup.tasteProfile.notes.length - 3} more\n              </Badge>\n            )}\n          </div>\n        </div>\n        \n        {/* Pricing */}\n        <div className=\"mb-4\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <div className=\"text-2xl font-bold text-gray-900\">\n              {regionalPricing.currency} {regionalPricing.price.toFixed(2)}\n            </div>\n            <div className=\"text-xs text-gray-500\">\n              {regionalPricing.retailer}\n            </div>\n          </div>\n         =\"text-xs text-gray-500\">\n            €{pricePer <div classNameMl.toFixed(3)}/ml\n          </div>\n          <div className=\"flex items-center space-x-1 text-xs text-gray-500\">\n            <MapPin className=\"h-3 w-3\" />\n            <span>Available in {region}</span>\n          </div>\n        </div>\n        \n        {/* Usage Guide Preview */}\n        <div className=\"mb-4 p-2 bg-gray-50 rounded-lg\">\n          <div className=\"text-xs text-gray-600 mb-1\">Recommended Use</div>\n          <div className=\"text-xs text-gray-800\">\n            {syrup.usageGuide.recommendedRatio} • Max {syrup.usageGuide.maxDaily}ml/day\n          </div>\n        </div>\n        \n        {/* Actions */}\n        <div className=\"mt-auto space-y-2\">\n          {showQuickActions && (\n            <div className=\"flex items-center space-x-2\">\n              <Select value={quantity.toString()} onValueChange={(value) => setQuantity(parseInt(value))}>\n                <SelectTrigger className=\"w-20\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"1\">1</SelectItem>\n                  <SelectItem value=\"2\">2</SelectItem>\n                  <SelectItem value=\"3\">3</SelectItem>\n                  <SelectItem value=\"6\">6</SelectItem>\n                  <SelectItem value=\"12\">12</SelectItem>\n                </SelectContent>\n              </Select>\n              <Button \n                onClick={handleAddToCart}\n                disabled={isAddingToCart || syrup.availability === 'out-of-stock'}\n                className=\"flex-1\"\n                size=\"sm\"\n              >\n                {isAddingToCart ? (\n                  <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <>\n                    <ShoppingCart className=\"h-4 w-4 mr-1\" />\n                    Add to Cart\n                  </>\n                )}\n              </Button>\n            </div>\n          )}\n          \n          <div className=\"flex space-x-2\">\n            <Button variant=\"outline\" size=\"sm\" onClick={() => onSelect(syrup)} className=\"flex-1\">\n              View Details\n            </Button>\n            {regionalPricing.affiliateUrl && (\n              <Button variant=\"outline\" size=\"sm\" asChild>\n                <a href={regionalPricing.affiliateUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                  <ExternalLink className=\"h-4 w-4\" />\n                </a>\n              </Button>\n            )}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\n/**\n * Comparison Modal Component\n */\nconst ComparisonModal: React.FC<ComparisonModalProps> = ({\n  selectedSyrups,\n  region,\n  isOpen,\n  onClose,\n  onSelectForComparison\n}) => {\n  if (selectedSyrups.length === 0) return null;\n  \n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-6xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Compare Syrups</DialogTitle>\n          <DialogDescription>\n            Compare features, pricing, and specifications side by side\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4\">\n          {selectedSyrups.map((syrup) => {\n            const pricing = syrup.regionalPricing[region] || Object.values(syrup.regionalPricing)[0];\n            \n            return (\n              <Card key={syrup.id} className=\"p-4\">\n                <div className=\"space-y-3\">\n                  <div>\n                    <h3 className=\"font-semibold text-sm line-clamp-2\">{syrup.name}</h3>\n                    <p className=\"text-xs text-gray-600\">{syrup.brand}</p>\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-1\">\n                    <Star className=\"h-3 w-3 text-yellow-400 fill-current\" />\n                    <span className=\"text-xs\">{syrup.rating.toFixed(1)}</span>\n                    <span className=\"text-xs text-gray-500\">({syrup.reviewCount})</span>\n                  </div>\n                  \n                  <div className=\"text-lg font-bold\">\n                    {pricing.currency} {pricing.price.toFixed(2)}\n                  </div>\n                  \n                  <div className=\"space-y-1 text-xs\">\n                    <div className=\"flex justify-between\">\n                      <span>Concentration:</span>\n                      <span>{syrup.concentration}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span>Dilution:</span>\n                      <span>{syrup.dilutionRatio}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span>Sweetness:</span>\n                      <span>{syrup.tasteProfile.sweetness}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span>Intensity:</span>\n                      <span>{syrup.tasteProfile.intensity}</span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex flex-wrap gap-1\">\n                    {syrup.tasteProfile.notes.slice(0, 3).map((note, index) => (\n                      <Badge key={index} variant=\"outline\" className=\"text-xs\">\n                        {note}\n                      </Badge>\n                    ))}\n                  </div>\n                  \n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\" \n                    onClick={() => onSelectForComparison(syrup)}\n                    className=\"w-full\"\n                  >\n                    Select This Syrup\n                  </Button>\n                </div>\n              </Card>\n            );\n          })}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\n/**\n * Main Syrup Marketplace Component\n */\nexport const SyrupMarketplace: React.FC<SyrupMarketplaceProps> = ({\n  initialFilter = {},\n  region = 'EU',\n  currency = 'EUR',\n  onSyrupSelect,\n  onAddToCart,\n  showQuickActions = true,\n  enableComparison = false,\n  className = ''\n}) => {\n  const [syrups, setSyrups] = useState<PremadeSyrup[]>([]);\n  const [filteredSyrups, setFilteredSyrups] = useState<PremadeSyrup[]>([]);\n  const [recommendations, setRecommendations] = useState<SyrupRecommendation[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedSyrups, setSelectedSyrups] = useState<PremadeSyrup[]>([]);\n  const [favorites, setFavorites] = useState<Set<string>>(new Set());\n  const [showFilters, setShowFilters] = useState(false);\n  const [activeTab, setActiveTab] = useState('all');\n  \n  // Initialize syrup service\n  const syrupService = useMemo(() => new PremadeSyrupService(), []);\n  \n  // Filter state\n  const [filters, setFilters] = useState<FilterState>({\n    searchQuery: '',\n    selectedBrands: [],\n    selectedCategories: [],\n    selectedConcentrations: [],\n    priceRange: { min: 0, max: 50 },\n    selectedAvailability: [],\n    minRating: 0,\n    compatibleFlavors: [],\n    sortBy: 'popularity',\n    sortOrder: 'desc',\n    ...initialFilter\n  });\n  \n  // Load syrups on mount\n  useEffect(() => {\n    const loadSyrups = async () => {\n      try {\n        setLoading(true);\n        const allSyrups = syrupService.getAllSyrups();\n        setSyrups(allSyrups);\n        setFilteredSyrups(allSyrups);\n      } catch (error) {\n        console.error('Failed to load syrups:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    loadSyrups();\n  }, [syrupService]);\n  \n  // Apply filters\n  useEffect(() => {\n    const applyFilters = () => {\n      let filtered = [...syrups];\n      \n      // Search query\n      if (filters.searchQuery) {\n        const query = filters.searchQuery.toLowerCase();\n        filtered = filtered.filter(syrup => \n          syrup.name.toLowerCase().includes(query) ||\n          syrup.description.toLowerCase().includes(query) ||\n          syrup.brand.toLowerCase().includes(query) ||\n          syrup.tasteProfile.notes.some(note => note.toLowerCase().includes(query))\n        );\n      }\n      \n      // Brand filter\n      if (filters.selectedBrands.length > 0) {\n        filtered = filtered.filter(syrup => filters.selectedBrands.includes(syrup.brand));\n      }\n      \n      // Category filter\n      if (filters.selectedCategories.length > 0) {\n        filtered = filtered.filter(syrup => filters.selectedCategories.includes(syrup.category));\n      }\n      \n      // Concentration filter\n      if (filters.selectedConcentrations.length > 0) {\n        filtered = filtered.filter(syrup => filters.selectedConcentrations.includes(syrup.concentration));\n      }\n      \n      // Availability filter\n      if (filters.selectedAvailability.length > 0) {\n        filtered = filtered.filter(syrup => filters.selectedAvailability.includes(syrup.availability));\n      }\n      \n      // Price range filter\n      filtered = filtered.filter(syrup => {\n        const prices = Object.values(syrup.regionalPricing).map(p => p.price);\n        const minPrice = Math.min(...prices);\n        return minPrice >= filters.priceRange.min && minPrice <= filters.priceRange.max;\n      });\n      \n      // Rating filter\n      if (filters.minRating > 0) {\n        filtered = filtered.filter(syrup => syrup.rating >= filters.minRating);\n      }\n      \n      // Sort results\n      filtered.sort((a, b) => {\n        let comparison = 0;\n        \n        switch (filters.sortBy) {\n          case 'price':\n            const aPrice = Math.min(...Object.values(a.regionalPricing).map(p => p.price));\n            const bPrice = Math.min(...Object.values(b.regionalPricing).map(p => p.price));\n            comparison = aPrice - bPrice;\n            break;\n          case 'rating':\n            comparison = a.rating - b.rating;\n            break;\n          case 'popularity':\n            comparison = a.reviewCount - b.reviewCount;\n            break;\n          case 'name':\n            comparison = a.name.localeCompare(b.name);\n            break;\n        }\n        \n        return filters.sortOrder === 'desc' ? -comparison : comparison;\n      });\n      \n      setFilteredSyrups(filtered);\n    };\n    \n    applyFilters();\n  }, [syrups, filters]);\n  \n  // Get available filter options\n  const availableBrands = useMemo(() => syrupService.getBrands(), [syrupService]);\n  const availableCategories = useMemo(() => syrupService.getCategories(), [syrupService]);\n  const availableConcentrations = useMemo(() => syrupService.getConcentrations(), [syrupService]);\n  \n  // Handle filter changes\n  const updateFilter = (key: keyof FilterState, value: any) => {\n    setFilters(prev => ({ ...prev, [key]: value }));\n  };\n  \n  // Handle syrup selection\n  const handleSyrupSelect = (syrup: PremadeSyrup) => {\n    if (enableComparison) {\n      if (selectedSyrups.find(s => s.id === syrup.id)) {\n        setSelectedSyrups(prev => prev.filter(s => s.id !== syrup.id));\n      } else if (selectedSyrups.length < 3) {\n        setSelectedSyrups(prev => [...prev, syrup]);\n      }\n    } else {\n      onSyrupSelect?.(syrup);\n    }\n  };\n  \n  // Handle favorite toggle\n  const handleToggleFavorite = (syrupId: string) => {\n    setFavorites(prev => {\n      const newFavorites = new Set(prev);\n      if (newFavorites.has(syrupId)) {\n        newFavorites.delete(syrupId);\n      } else {\n        newFavorites.add(syrupId);\n      }\n      return newFavorites;\n    });\n  };\n  \n  // Load recommendations\n  const loadRecommendations = (flavor: string) => {\n    const recs = syrupService.getRecommendations(flavor, {\n      availability: 'in-stock'\n    });\n    setRecommendations(recs);\n  };\n  \n  // Get trending syrups\n  const trendingSyrups = useMemo(() => {\n    return [...syrups]\n      .sort((a, b) => b.reviewCount - a.reviewCount)\n      .slice(0, 6);\n  }, [syrups]);\n  \n  // Get best value syrups\n  const bestValueSyrups = useMemo(() => {\n    return filteredSyrups\n      .filter(syrup => {\n        const prices = Object.values(syrup.regionalPricing).map(p => p.price);\n        const minPrice = Math.min(...prices);\n        return minPrice <= 15 && syrup.rating >= 4.0;\n      })\n      .slice(0, 6);\n  }, [filteredSyrups]);\n  \n  if (loading) {\n    return (\n      <div className={`space-y-6 ${className}`}>\n        <div className=\"flex items-center justify-between\">\n          <Skeleton className=\"h-8 w-48\" />\n          <Skeleton className=\"h-10 w-32\" />\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {Array.from({ length: 6 }).map((_, i) => (\n            <Card key={i} className=\"h-96\">\n              <CardHeader>\n                <Skeleton className=\"h-6 w-3/4\" />\n                <Skeleton className=\"h-4 w-1/2\" />\n              </CardHeader>\n              <CardContent>\n                <Skeleton className=\"h-32 w-full mb-4\" />\n                <Skeleton className=\"h-4 w-full mb-2\" />\n                <Skeleton className=\"h-4 w-2/3\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    );\n  }\n  \n  return (\n    <TooltipProvider>\n      <div className={`space-y-6 ${className}`}>\n        {/* Header */}\n        <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Syrup Marketplace</h1>\n            <p className=\"text-gray-600 mt-1\">\n              Discover premium syrups from top brands • {filteredSyrups.length} products available\n            </p>\n          </div>\n          \n          <div className=\"flex items-center space-x-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setShowFilters(!showFilters)}\n              className=\"flex items-center space-x-2\"\n            >\n              <Filter className=\"h-4 w-4\" />\n              <span>Filters</span>\n              <ChevronDown className={`h-4 w-4 transition-transform ${showFilters ? 'rotate-180' : ''}`} />\n            </Button>\n            \n            {enableComparison && selectedSyrups.length > 0 && (\n              <Button\n                variant=\"default\"\n                onClick={() => {/* Open comparison modal */}}\n                className=\"flex items-center space-x-2\"\n              >\n                <BarChart3 className=\"h-4 w-4\" />\n                <span>Compare ({selectedSyrups.length})</span>\n              </Button>\n            )}\n          </div>\n        </div>\n        \n        {/* Search and Filters */}\n        <div className=\"space-y-4\">\n          <div className=\"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4\">\n            <div className=\"flex-1 relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n              <Input\n                placeholder=\"Search syrups by name, brand, or flavor...\"\n                value={filters.searchQuery}\n                onChange={(e) => updateFilter('searchQuery', e.target.value)}\n                className=\"pl-10\"\n              />\n            </div>\n            \n            <Select value={filters.sortBy} onValueChange={(value) => updateFilter('sortBy', value)}>\n              <SelectTrigger className=\"w-48\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"popularity\">Most Popular</SelectItem>\n                <SelectItem value=\"price\">Price</SelectItem>\n                <SelectItem value=\"rating\">Highest Rated</SelectItem>\n                <SelectItem value=\"name\">Name</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          \n          {/* Advanced Filters */}\n          {showFilters && (\n            <Card className=\"p-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n                {/* Brands */}\n                <div>\n                  <Label className=\"text-sm font-medium\">Brands</Label>\n                  <div className=\"mt-2 space-y-2 max-h-32 overflow-y-auto\">\n                    {availableBrands.map(brand => (\n                      <label key={brand} className=\"flex items-center space-x-2\">\n                        <input\n                          type=\"checkbox\"\n                          checked={filters.selectedBrands.includes(brand)}\n                          onChange={(e) => {\n                            if (e.target.checked) {\n                              updateFilter('selectedBrands', [...filters.selectedBrands, brand]);\n                            } else {\n                              updateFilter('selectedBrands', filters.selectedBrands.filter(b => b !== brand));\n                            }\n                          }}\n                          className=\"rounded\"\n                        />\n                        <span className=\"text-sm\">{brand}</span>\n                      </label>\n                    ))}\n                  </div>\n                </div>\n                \n                {/* Categories */}\n                <div>\n                  <Label className=\"text-sm font-medium\">Categories</Label>\n                  <div className=\"mt-2 space-y-2 max-h-32 overflow-y-auto\">\n                    {availableCategories.map(category => (\n                      <label key={category} className=\"flex items-center space-x-2\">\n                        <input\n                          type=\"checkbox\"\n                          checked={filters.selectedCategories.includes(category)}\n                          onChange={(e) => {\n                            if (e.target.checked) {\n                              updateFilter('selectedCategories', [...filters.selectedCategories, category]);\n                            } else {\n                              updateFilter('selectedCategories', filters.selectedCategories.filter(c => c !== category));\n                            }\n                          }}\n                          className=\"rounded\"\n                        />\n                        <span className=\"text-sm capitalize\">{category}</span>\n                      </label>\n                    ))}\n                  </div>\n                </div>\n                \n                {/* Concentrations */}\n                <div>\n                  <Label className=\"text-sm font-medium\">Concentration</Label>\n                  <div className=\"mt-2 space-y-2 max-h-32 overflow-y-auto\">\n                    {availableConcentrations.map(concentration => (\n                      <label key={concentration} className=\"flex items-center space-x-2\">\n                        <input\n                          type=\"checkbox\"\n                          checked={filters.selectedConcentrations.includes(concentration)}\n                          onChange={(e) => {\n                            if (e.target.checked) {\n                              updateFilter('selectedConcentrations', [...filters.selectedConcentrations, concentration]);\n                            } else {\n                              updateFilter('selectedConcentrations', filters.selectedConcentrations.filter(c => c !== concentration));\n                            }\n                          }}\n                          className=\"rounded\"\n                        />\n                        <span className=\"text-sm capitalize\">{concentration}</span>\n                      </label>\n                    ))}\n                  </div>\n                </div>\n                \n                {/* Rating */}\n                <div>\n                  <Label className=\"text-sm font-medium\">Minimum Rating</Label>\n                  <div className=\"mt-2 space-y-2\">\n                    <input\n                      type=\"range\"\n                      min=\"0\"\n                      max=\"5\"\n                      step=\"0.5\"\n                      value={filters.minRating}\n                      onChange={(e) => updateFilter('minRating', parseFloat(e.target.value))}\n                      className=\"w-full\"\n                    />\n                    <div className=\"flex items-center space-x-1\">\n                      <Star className=\"h-3 w-3 text-yellow-400 fill-current\" />\n                      <span className=\"text-sm\">{filters.minRating.toFixed(1)}+ stars</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </Card>\n          )}\n        </div>\n        \n        {/* Content Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"grid w-full grid-cols-4\">\n            <TabsTrigger value=\"all\">All Syrups ({filteredSyrups.length})</TabsTrigger>\n            <TabsTrigger value=\"trending\">Trending</TabsTrigger>\n            <TabsTrigger value=\"best-value\">Best Value</TabsTrigger>\n            <TabsTrigger value=\"favorites\">Favorites ({favorites.size})</TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"all\" className=\"space-y-6\">\n            {filteredSyrups.length > 0 ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {filteredSyrups.map(syrup => (\n                  <SyrupCard\n                    key={syrup.id}\n                    syrup={syrup}\n                    region={region}\n                    onSelect={handleSyrupSelect}\n                    onAddToCart={onAddToCart || (() => {})}\n                    onToggleFavorite={handleToggleFavorite}\n                    isFavorite={favorites.has(syrup.id)}\n                    showQuickActions={showQuickActions}\n                    enableComparison={enableComparison}\n                  />\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center py-12\">\n                <Package className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No syrups found</h3>\n                <p className=\"text-gray-600\">Try adjusting your search criteria or filters</p>\n              </div>\n            )}\n          </TabsContent>\n          \n          <TabsContent value=\"trending\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {trendingSyrups.map(syrup => (\n                <SyrupCard\n                  key={syrup.id}\n                  syrup={syrup}\n                  region={region}\n                  onSelect={handleSyrupSelect}\n                  onAddToCart={onAddToCart || (() => {})}\n                  onToggleFavorite={handleToggleFavorite}\n                  isFavorite={favorites.has(syrup.id)}\n                  showQuickActions={showQuickActions}\n                  enableComparison={enableComparison}\n                />\n              ))}\n            </div>\n          </TabsContent>\n          \n          <TabsContent value=\"best-value\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n              {bestValueSyrups.map(syrup => (\n                <SyrupCard\n                  key={syrup.id}\n                  syrup={syrup}\n                  region={region}\n                  onSelect={handleSyrupSelect}\n                  onAddToCart={onAddToCart || (() => {})}\n                  onToggleFavorite={handleToggleFavorite}\n                  isFavorite={favorites.has(syrup.id)}\n                  showQuickActions={showQuickActions}\n                  enableComparison={enableComparison}\n                />\n              ))}\n            </div>\n          </TabsContent>\n          \n          <TabsContent value=\"favorites\" className=\"space-y-6\">\n            {favorites.size > 0 ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {syrups\n                  .filter(syrup => favorites.has(syrup.id))\n                  .map(syrup => (\n                    <SyrupCard\n                      key={syrup.id}\n                      syrup={syrup}\n                      region={region}\n                      onSelect={handleSyrupSelect}\n                      onAddToCart={onAddToCart || (() => {})}\n                      onToggleFavorite={handleToggleFavorite}\n                      isFavorite={favorites.has(syrup.id)}\n                      showQuickActions={showQuickActions}\n                      enableComparison={enableComparison}\n                    />\n                  ))}\n              </div>\n            ) : (\n              <div className=\"text-center py-12\">\n                <Heart className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No favorites yet</h3>\n                <p className=\"text-gray-600\">Start adding syrups to your favorites to see them here</p>\n              </div>\n            )}\n          </TabsContent>\n        </Tabs>\n        \n        {/* Comparison Modal */}\n        {enableComparison && (\n          <ComparisonModal\n            selectedSyrups={selectedSyrups}\n            region={region}\n            isOpen={selectedSyrups.length > 0}\n            onClose={() => setSelectedSyrups([])}\n            onSelectForComparison={onSyrupSelect || (() => {})}\n          />\n        )}\n      </div>\n    </TooltipProvider>\n  );\n};\n\nexport default SyrupMarketplace;"